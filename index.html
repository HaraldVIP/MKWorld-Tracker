<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MKWorld Tracker</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/themes.css">
</head>
<body data-theme="dark">
    <div class="credit">
        <div class="credit-line-1">Made by</div>
        <div class="credit-line-2">Harald VIP</div>
    </div>
    <button class="theme-button top-right" onclick="toggleTheme()">‚òÄÔ∏è Light Mode</button>
    <button class="help-button" onclick="toggleHelp()" title="Help">‚ùì</button>
    
    <!-- Session Toggle Button -->
    <button class="session-toggle-btn" id="sessionToggleBtn" onclick="toggleSessionMode()">Sessions</button>
    
    <!-- Session Sidebar -->
    <div class="session-sidebar" id="sessionSidebar">
        <div class="sidebar-content-wrapper">
            <div class="sidebar-header">
                <h3>Sessions</h3>
            </div>
        <div class="sidebar-content">
            <div class="create-session-section">
                <input type="text" id="newSessionName" placeholder="Session name..." maxlength="50">
                <button class="create-session-btn" onclick="createNewSession()">Create Session</button>
                <button class="import-session-btn" onclick="importSession()">üìÅ Import Session</button>
            </div>
            <div class="sessions-list" id="sessionsList">
                <!-- Sessions will be populated here -->
            </div>
        </div>
        </div>
    </div>
    
    <!-- Main Content Wrapper -->
    <div class="main-content-wrapper" id="mainContentWrapper">
    <div class="header">
        <a href="https://mkworldtracker.com" class="website-link" target="_blank" rel="noopener noreferrer">mkworldtracker.com</a>
        <div class="controls">
            <button class="reset-button" onclick="resetAll()">Reset All Tracks</button>
        </div>
        <div class="controls-row">
            <div class="left-controls">
                <div class="sort-controls">
                    <button class="sort-button active" id="sortAlphabetical" onclick="setSortMode('alphabetical')">A-Z</button>
                    <button class="sort-button" id="sortStarred" onclick="setSortMode('starred')">‚≠ê Favorited</button>
                    <button class="sort-button" id="sortRemaining" onclick="setSortMode('remaining')">Remaining</button>
                </div>
            </div>
            <div class="center-controls">
                <div class="stats-inline">
                    <span>Completed: <span id="completedTracks">0</span>/12 | <span id="sessionScore" class="session-score" style="display: none;">Score: <span id="scoreValue">0</span></span></span>
                    <div class="progress-bar-inline">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                        <div class="progress-percentage-overlay" id="progressPercentage">0%</div>
                    </div>
                </div>
            </div>
            <div class="right-controls">
                <div class="top-controls">
                    <button class="track-tip-toggle-button" id="trackTipToggleBtn" onclick="toggleTrackTipMode()">üí° Track Tips</button>
                    <button class="zoom-toggle-button" id="zoomToggleBtn" onclick="toggleAutoZoom()">üîç Zoom to Fit</button>
                    <button class="stats-button" onclick="showStats()" title="View track statistics">üìä Stats</button>
                </div>
                <div class="bottom-controls">
                    <div class="manual-zoom-controls" id="manualZoomControls" style="display: none;">
                        <span class="zoom-indicator">üîç</span>
                        <input type="range" class="size-slider" id="sizeSlider" min="0.5" max="5" step="0.1" value="3" oninput="adjustSize(this.value)">
                    </div>
                    <button class="discord-copy-button" onclick="copyDiscordCodes()" title="Copy completed tracks for Discord">üìã Copy played tracks</button>
                    <button class="tips-button" onclick="openTipsForm()" title="Help gather track tips and shortcuts">üí° Help gather track tips!</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="track-grid" id="trackGrid">
        <!-- Track items will be generated by JavaScript -->
    </div>

    <!-- Help Modal -->
    <div class="help-modal" id="helpModal">
        <div class="help-content">
            <div class="help-header">
                <h2>MKWorld Tracker - How to Use</h2>
                <button class="help-close" onclick="toggleHelp()">&times;</button>
            </div>
            <div class="help-body">
                <h3>üéØ Basic Usage</h3>
                <ul>
                    <li><strong>Click tracks</strong> to mark them as completed/incomplete</li>
                    <li><strong>Press F key</strong> while hovering over a track to favorite/unfavorite it</li>
                </ul>
                
                <h3>üìä Sessions</h3>
                <ul>
                    <li><strong>Save different play sessions</strong> to track your racing progress</li>
                    <li><strong>Set placements</strong> for completed tracks (1st-12th place)</li>
                    <li><strong>Quick placement selection</strong> - Click the placement button to open a grid, or use keyboard shortcuts (1-9, 0 for 10th, - for 11th, = for 12th)</li>
                    <li><strong>Add notes</strong> to remember details about each race</li>
                    <li><strong>Import/Export</strong> sessions to share with others</li>
                    <li><strong>Score calculation</strong> - Automatic scoring based on placements</li>
                    <li><strong>Discord export</strong> - Copy track codes for Discord</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Stats Modal -->
    <div class="stats-modal" id="statsModal">
        <div class="stats-content">
            <div class="stats-header">
                <h2>üìä Track Statistics</h2>
                <button class="stats-close" onclick="toggleStats()">&times;</button>
            </div>
            <div class="stats-body">
                <div class="stats-summary">
                    <div class="stat-item">
                        <span class="stat-label">Total Sessions:</span>
                        <span class="stat-value" id="totalSessions">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Total Races:</span>
                        <span class="stat-value" id="totalRaces">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Average Score per Session:</span>
                        <span class="stat-value" id="avgScorePerSession">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Overall Average Placement:</span>
                        <span class="stat-value" id="overallAvgPlacement">0</span>
                    </div>
                </div>
                <div class="stats-tracks" id="statsTracks">
                    <!-- Track statistics will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Track Tip Modal -->
    <div class="track-tip-modal" id="trackTipModal">
        <div class="track-tip-content">
            <div class="track-tip-header">
                <h2 id="trackTipTitle">Track Tips</h2>
                <button class="track-tip-close" onclick="closeTrackTip()">&times;</button>
            </div>
            <div class="track-tip-body">
                <div class="track-tip-placeholder">
                    <p>Track information will be displayed here.</p>
                    <p>This is a placeholder for future track tips and strategies.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript files loaded in dependency order -->
    </div> <!-- End main-content-wrapper -->
    
    <script src="js/dataStorage.js"></script>
    <script src="js/trackManager.js"></script>
    <script src="js/sessionManager.js"></script>
    <script src="js/uiControls.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
